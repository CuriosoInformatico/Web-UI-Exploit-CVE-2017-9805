from flask import Flask, render_template, jsonify, request
import json
import struts_pwn

app = Flask(__name__)

@app.route('/')
def index():
    return render_template('base.html')


@app.route('/test', methods=['POST'])
def test():
    response = {
        'urls': []
    }

    if request.form.get('urls'):
        urls = json.loads(request.form.get('urls'))
        for url in urls:
            url = url.strip()
            if url:
                this_url = {
                    'url': url,
                    'vuln': struts_pwn.check(url)
                }
                response['urls'].append(this_url)

    return jsonify(response)

def run():
    app.run(port=3333)

if __name__ == '__main__':
    run()
