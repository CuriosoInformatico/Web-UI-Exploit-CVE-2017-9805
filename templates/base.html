<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
  <script
			  src="https://code.jquery.com/jquery-3.2.1.min.js"
			  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
			  crossorigin="anonymous"></script>

  <title>CVE-2017-9805</title>
</head>
<body>
  <header>
    <img src="https://struts.apache.org/img/struts-logo.svg" alt="">
    <br>
    <h1>CVE-2017-9805</h1>
  </header>
  <section id="inputs">
    <h3>URLs</h3>
    <textarea name="" id="urls">

    </textarea>


    <ul id="results">

    </ul>


    <footer>
      <button id="test">Test</button>
      <button id="fire">Fire</button>
    </footer>

  </section>

  <script>
    $('#test').click(
      function(){
        if ($('#urls').val().trim() == ''){
          alert('');
        }
        $.ajax(
          {
            url: '{{url_for('test')}}',
            type: 'POST',
            data: {
              urls: JSON.stringify($('#urls').val().split('\n'))
            },
            success: view_test,
            error: (ev) => alert('Wops! There\'s a bug')
          }
        );
      }
    );


  $('#fire').click(
      (ev) => alert('Not implemented yet. Try Test')
  );

  function view_test(data){
    $('#results').html('');
    for (let url of data['urls']){
      $('#results').append(
        $('<li>').text(url.url).css({
          'background': url.vuln ? 'red' : '#7bee86'
        })
      );
    }

  }

  </script>

<!--
  CrÃ©ditos:
  Exploit: https://github.com/mazen160/struts-pwn_CVE-2017-9805
  Plataforma Web: @elchicodepython
-->


</body>
</html>
